# 3.3 斷點調試基礎

斷點調試是一種強大的除錯技術，它允許我們暫停程式的執行，並在特定時刻檢查程式的狀態。想像成是在看影片時按下暫停鍵，讓我們能仔細觀察某個特定時刻的畫面。

## 什麼是斷點？

斷點是在程式碼中設置的一個「暫停點」，當程式執行到這個位置時會自動暫停，讓開發者能夠：
1. 檢查當前的變數值
2. 查看程式的執行狀態
3. 逐步執行程式碼
4. 追蹤程式的執行流程

## 斷點的類型

### 1. 行斷點（Line Breakpoint）
最基本和常用的斷點類型：
- 點擊程式碼行號即可設置
- 程式執行到該行時會暫停
- 再次點擊可以移除斷點

### 2. 條件斷點（Conditional Breakpoint）
只在特定條件成立時才會暫停：
```javascript
// 例如：只在 score 大於 90 時暫停
if (score > 90) {
    console.log('優秀！');  // 在這裡設置條件斷點
}
```

### 3. DOM 斷點（DOM Breakpoint）
當網頁元素發生變化時暫停：
- 子節點修改時
- 屬性修改時
- 節點移除時

## 如何設置斷點

### 1. 設置行斷點
1. 在 Sources 面板中打開要除錯的檔案
2. 點擊程式碼左側的行號
3. 會出現一個藍色的標記，表示斷點已設置

### 2. 設置條件斷點
1. 在行號上右鍵點擊
2. 選擇「Add conditional breakpoint」
3. 輸入條件表達式（例如：`count > 5`）

### 3. 設置 DOM 斷點
1. 在 Elements 面板中選擇元素
2. 右鍵點擊元素
3. 選擇「Break on」子選單中的選項

## 基本的斷點操作

### 1. 暫停/繼續執行
- 暫停按鈕（⏸）：手動暫停程式執行
- 繼續按鈕（▶）：繼續執行到下一個斷點

### 2. 單步執行
- Step Over（⤵）：執行當前行，不進入函數內部
- Step Into（➡）：進入函數內部
- Step Out（⬆）：跳出當前函數

### 3. 查看變數值
當程式暫停時，你可以：
- 在 Scope 面板查看所有變數
- 將滑鼠懸停在程式碼中的變數上
- 在 Console 中輸入變數名稱查看值

## 實戰練習

### 1. 基礎斷點練習
```javascript
function calculateTotal(price, quantity) {
    const subtotal = price * quantity;  // 設置斷點在這裡
    const tax = subtotal * 0.1;
    return subtotal + tax;
}

const total = calculateTotal(100, 2);
console.log('總金額：', total);
```

### 2. 條件斷點練習
```javascript
function processScores(scores) {
    scores.forEach(score => {
        if (score < 60) {  // 設置條件斷點：score < 60
            console.log('需要補考');
        }
    });
}

processScores([85, 55, 92, 45, 78]);
```

## 調試技巧

1. **漸進式調試**
   - 從可能出問題的地方開始設置斷點
   - 逐步縮小問題範圍
   - 觀察變數值的變化

2. **使用 Watch 表達式**
   - 在 Watch 面板添加想要監視的表達式
   - 即時查看表達式的計算結果

3. **善用 Call Stack**
   - 查看函數調用的層級關係
   - 了解程式執行的路徑

## 常見問題解答

Q：斷點設置了但程式沒有停下來？
A：可能的原因：
1. 程式碼沒有執行到該行
2. 條件斷點的條件沒有滿足
3. 程式碼被壓縮或轉換過

Q：如何在程式執行很快的時候準確打斷點？
A：可以先用 `debugger` 語句在程式碼中設置斷點：
```javascript
function fastFunction() {
    debugger;  // 程式會在這裡自動暫停
    // 其他程式碼
}
```

Q：如何知道該在哪裡設置斷點？
A：通常可以：
1. 從錯誤訊息提示的位置開始
2. 從程式的關鍵邏輯處開始
3. 從資料發生變化的地方開始

## 小提醒

- 斷點調試可能會影響程式的執行效能
- 記得在調試完成後移除所有斷點
- 合理使用條件斷點，避免程式過度暫停
- 善用快捷鍵可以提高調試效率
- 調試時保持耐心，問題總會找到答案 