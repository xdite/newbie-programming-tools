<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
    <!-- 背景 -->
    <rect width="800" height="600" fill="#ffffff"/>
    
    <!-- 標題 -->
    <text x="250" y="40" font-family="Arial" font-size="24" fill="#2d3748" font-weight="bold">數據分析報告流程</text>
    
    <!-- 中央處理流程 -->
    <g transform="translate(100,80)">
        <!-- 第一層：數據收集 -->
        <g>
            <rect width="600" height="140" fill="#ebf8ff" stroke="#3182ce" stroke-width="2" rx="10"/>
            <text x="250" y="35" font-family="Arial" font-size="20" fill="#2b6cb0" font-weight="bold">數據收集</text>
            
            <!-- 收集項目 -->
            <g transform="translate(20,50)">
                <rect width="170" height="70" fill="#bee3f8" stroke="#3182ce" stroke-width="1" rx="5"/>
                <text x="20" y="25" font-family="Arial" font-size="16" fill="#2b6cb0">Excel報表</text>
                <text x="20" y="45" font-family="Arial" font-size="12" fill="#2b6cb0">• 數據匯入</text>
                <text x="20" y="60" font-family="Arial" font-size="12" fill="#2b6cb0">• 格式轉換</text>
            </g>
            
            <g transform="translate(215,50)">
                <rect width="170" height="70" fill="#bee3f8" stroke="#3182ce" stroke-width="1" rx="5"/>
                <text x="20" y="25" font-family="Arial" font-size="16" fill="#2b6cb0">系統API</text>
                <text x="20" y="45" font-family="Arial" font-size="12" fill="#2b6cb0">• 即時數據</text>
                <text x="20" y="60" font-family="Arial" font-size="12" fill="#2b6cb0">• 歷史記錄</text>
            </g>
            
            <g transform="translate(410,50)">
                <rect width="170" height="70" fill="#bee3f8" stroke="#3182ce" stroke-width="1" rx="5"/>
                <text x="20" y="25" font-family="Arial" font-size="16" fill="#2b6cb0">人工表單</text>
                <text x="20" y="45" font-family="Arial" font-size="12" fill="#2b6cb0">• 手動輸入</text>
                <text x="20" y="60" font-family="Arial" font-size="12" fill="#2b6cb0">• 數據校驗</text>
            </g>
        </g>
        
        <!-- 第二層：智能分析 -->
        <g transform="translate(0,160)">
            <rect width="600" height="180" fill="#faf5ff" stroke="#805ad5" stroke-width="2" rx="10"/>
            <text x="250" y="35" font-family="Arial" font-size="20" fill="#6b46c1" font-weight="bold">智能分析</text>
            
            <!-- LLM處理 -->
            <g transform="translate(20,50)">
                <rect width="270" height="110" fill="#e9d8fd" stroke="#805ad5" stroke-width="1" rx="5"/>
                <text x="100" y="25" font-family="Arial" font-size="16" fill="#6b46c1">LLM 處理</text>
                <text x="20" y="45" font-family="Arial" font-size="12" fill="#6b46c1">• 趨勢分析與預測</text>
                <text x="20" y="65" font-family="Arial" font-size="12" fill="#6b46c1">• 異常數據識別</text>
                <text x="20" y="85" font-family="Arial" font-size="12" fill="#6b46c1">• 智能建議生成</text>
            </g>
            
            <!-- 程式處理 -->
            <g transform="translate(310,50)">
                <rect width="270" height="110" fill="#e9d8fd" stroke="#805ad5" stroke-width="1" rx="5"/>
                <text x="100" y="25" font-family="Arial" font-size="16" fill="#6b46c1">程式處理</text>
                <text x="20" y="45" font-family="Arial" font-size="12" fill="#6b46c1">• 統計數據計算</text>
                <text x="20" y="65" font-family="Arial" font-size="12" fill="#6b46c1">• 動態圖表生成</text>
                <text x="20" y="85" font-family="Arial" font-size="12" fill="#6b46c1">• 報表自動格式化</text>
            </g>
        </g>
        
        <!-- 第三層：多形式輸出 -->
        <g transform="translate(0,360)">
            <rect width="600" height="140" fill="#fff5f5" stroke="#e53e3e" stroke-width="2" rx="10"/>
            <text x="250" y="35" font-family="Arial" font-size="20" fill="#c53030" font-weight="bold">多形式輸出</text>
            
            <!-- 輸出項目 -->
            <g transform="translate(20,50)">
                <rect width="170" height="70" fill="#fed7d7" stroke="#e53e3e" stroke-width="1" rx="5"/>
                <text x="20" y="25" font-family="Arial" font-size="16" fill="#c53030">圖表展示</text>
                <text x="20" y="45" font-family="Arial" font-size="12" fill="#c53030">• 互動圖表</text>
                <text x="20" y="60" font-family="Arial" font-size="12" fill="#c53030">• 即時更新</text>
            </g>
            
            <g transform="translate(215,50)">
                <rect width="170" height="70" fill="#fed7d7" stroke="#e53e3e" stroke-width="1" rx="5"/>
                <text x="20" y="25" font-family="Arial" font-size="16" fill="#c53030">PDF報告</text>
                <text x="20" y="45" font-family="Arial" font-size="12" fill="#c53030">• 完整報告</text>
                <text x="20" y="60" font-family="Arial" font-size="12" fill="#c53030">• 分析建議</text>
            </g>
            
            <g transform="translate(410,50)">
                <rect width="170" height="70" fill="#fed7d7" stroke="#e53e3e" stroke-width="1" rx="5"/>
                <text x="20" y="25" font-family="Arial" font-size="16" fill="#c53030">郵件摘要</text>
                <text x="20" y="45" font-family="Arial" font-size="12" fill="#c53030">• 重點概述</text>
                <text x="20" y="60" font-family="Arial" font-size="12" fill="#c53030">• 定期推送</text>
            </g>
        </g>
    </g>
    
    <!-- 連接箭頭 -->
    <g>
        <!-- 第一層到第二層 -->
        <path d="M 400,220 L 400,240" stroke="#4a5568" stroke-width="2" marker-end="url(#arrow)"/>
        <!-- 第二層到第三層 -->
        <path d="M 400,420 L 400,440" stroke="#4a5568" stroke-width="2" marker-end="url(#arrow)"/>
    </g>
    
    <!-- 左側流程說明 -->
    <g transform="translate(50,250)">
        <text x="0" y="0" font-family="Arial" font-size="14" fill="#4a5568">處理流程</text>
        <path d="M 0,20 L 0,200" stroke="#4a5568" stroke-width="2" stroke-dasharray="5,5"/>
        <path d="M -5,200 L 0,210 L 5,200" fill="none" stroke="#4a5568" stroke-width="2"/>
    </g>
    
    <!-- 箭頭標記定義 -->
    <defs>
        <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5"
                markerWidth="6" markerHeight="6"
                orient="auto-start-reverse">
            <path d="M 0 0 L 10 5 L 0 10 z" fill="#4a5568"/>
        </marker>
    </defs>
</svg> 